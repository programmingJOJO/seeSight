<ion-view view-title="Tour">
  <div class="bar bar-subheader">
    <h2 class="title">{{tour.name}}</h2>
  </div>
  <ion-content class="has-subheader">
    <leaflet center="center" defaults="defaults" height="150px" markers="markers">
      <input type="text" ng-model="center.lat" style="margin-left:200px;" />
      <input type="text" ng-model="center.lng" style="margin-left:200px;" />
    </leaflet>
    <div id="start-button-item" class="item">
      <button class="ng-hide button-round button button-default button-fab button-icon-only button-assertive button-fab-top"
              ui-sref="app.tour_start({tourId: tour.id, placeId: tour.tour_places[0].id})" fab-top="" fab-center="" fab=""
              ng-click="newUserTour()"
              ng-show="user_tour.completed || !userTourHasPause()">
        <span class="button-inner">{{!user_tour.completed ? 'LOS!' : 'NEU'}}</span>
        <ion-button-effect></ion-button-effect>
      </button>
      <p>{{tour.description}}</p>
      <p><span class="balanced-bg" ng-repeat="tag in tour.tags">{{tag.name}} </span> </p>
    </div>
    <ion-list>
      <div class="item item-divider">
        Zielorte
      </div>
      <ion-item ng-repeat="tour_place in (correctTourPlaces = (tour.tour_places | orderBy:'id'))"
                ng-class="{'item-button-right': isPlaceVisited(correctTourPlaces[$index - 1]) && !isPlaceVisited(tour_place)}">
        {{$index + 1}}.
        {{tour_place.place.name}}
        <span ng-if="isPlaceVisited(tour_place)" class="item-note">
          bereits besucht
        </span>
        <button class="button button-assertive"
                ng-if="isPlaceVisited(correctTourPlaces[$index - 1]) && !isPlaceVisited(tour_place)"
                ui-sref="app.tour_start({tourId: tour.id, placeId: tour_place.place.id})">
          Fortsetzen
        </button>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-view>
